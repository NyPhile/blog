<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>这个 + 那个</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0,  minimum-scale=1.0, maximum-scale=1.0">
	<style type="text/css">
		html,body{height: 100%;}*{margin: 0;padding: 0;font-family: "微软雅黑";line-height: 1;position: relative;}
		.top,.btm{height: 33.3%;text-align: center;color: #fff;font-size:2em;position: relative;overflow: hidden;}
		.top{background: #46C579;}.btm{background: #3CAC69;}
		.btn{height:33.3%;font-family: Arial;font-size: 2em;text-align: center;display: -webkit-flex;}
		.lock{position: absolute;font-size: 0.5em;color: rgba(255,255,255,0.75);right: 1em;bottom: 1em;display: none;z-index: 99;}
		.btn p{padding: 0 2em;border:1px solid #3CAC69;border-radius: 2em;line-height: 2em;color: #3CAC69;margin: auto;}
		.welcome{position: absolute;left: 0;top: 0;width: 100%;height: 100%;background:#fff; z-index: 10;overflow: hidden;}
		.page_top,.page_btm{width: 100%;height:100%;display: -webkit-flex;color: #fff;font-size: 2em;background: #46C579;}
		.page_top p,.page_btm p{margin:auto;}
		.page_btm{background: #3CAC69;height: 50%;position: relative;}
		.item {position: absolute;width: 100%;height: 100%;left: 0;top: 0;display: -webkit-flex;opacity: 0;}
		.item span{margin:auto;}
		.active{-webkit-animation: push-in 0.6s;opacity: 1;}
		.none{-webkit-animation: push-out 0.6s;opacity: 0;}
		@-webkit-keyframes push-in {
			0% {
			  opacity: 0;
			  -webkit-transform: translateX(100%);
			}
			60% {
			  opacity: 1;
			  -webkit-transform: translateX(-10%);
			}
			100% {
			  opacity: 1;
			  -webkit-transform: translateX(0%);
			}
		}
		@-webkit-keyframes push-out {
			0% {
			  opacity: 1;
			  -webkit-transform: translateX(0);
			}
			60% {
			  opacity: 0;
			  -webkit-transform: translateX(-110%);
			}
			100% {
			  opacity: 0;
			  -webkit-transform: translateX(-100%);
			}
		}
	</style>
	<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
</head>
<body>
	<div class="welcome">
		<div class="page_top"><p>这个</p></div>
		<div class="page_btm"><p>那个</p></div>
		<div class="btn" id="btn">
			<p>shake</p>
		</div>
	</div>
	<div class="top" id="top" onclick="lockp1()">
		<span class="lock">锁定</span><div class="item active"><span>土豆</span></div>
	</div>
	<div class="btm" id="btm" onclick="lockp2()">
		<span class="lock">锁定</span><div class="item active"><span>好吃</span></div>
	</div>
	<div class="btn" id="btn">
		<p onclick="shake()">shake</p>
	</div>
	<script type="text/javascript">
		var _char = [ "高速铁路","达·芬奇","存款","火腿","杀人游戏","自驾游","玄关","文化遗产","队长","报纸","移动","编程","等级","点数","文章","匿名","银行","杂志","灰色","法律","功能","海参","股票","新秀","场所","单身公寓","舞蹈","线索"];
		$(".page_top").animate({height:'50%'},1200,step2);
		function step2 () {
			var t=setTimeout("$('.page_top').animate({height:'33.3%'},1200,step3);$('.page_btm').animate({height:'33.3%'},1200)",1000)	
		}
		function step3 () {
			$(".welcome").animate({opacity: '0'},500);
			var t=setTimeout("$('.welcome').hide()",500);
		}
		var lockp1flag = 0, lockp2flag = 0,p1index = 0,p2index = 0;
		function lockp1 () {
			if(lockp1flag == 0){
				lockp1flag = 1;
				$("#top .lock").show();
			}
			else{
				lockp1flag = 0;
				$("#top .lock").hide();
			}
		}
		function lockp2 () {
			if(lockp2flag == 0){
				lockp2flag= 1;
				$("#btm span").show();
			}
			else{
				lockp2flag = 0;
				$("#btm span").hide();
			}	
		}
		function shake(){
			var i = parseInt(_char.length*Math.random());
			var j = parseInt(_char.length*Math.random());
			if(!lockp1flag){
				$($("#top .item")[p1index]).after('<div class="item none"><span>'+_char[i]+'</span></div>');
				$("#top .active").removeClass("active").addClass("none");
				p1index+=1;
				$($("#top .item")[p1index]).removeClass("none").addClass("active");	
			}
			if(!lockp2flag){
				$($("#btm .item")[p2index]).after('<div class="item none"><span>'+_char[j]+'</span></div>');
				$("#btm .active").removeClass("active").addClass("none");
				p2index+=1;
				$($("#btm .item")[p2index]).removeClass("none").addClass("active");	
			}
			if(lockp1flag && lockp2flag){
				alert("全锁了！怎么换嘛！");
			}
		};
		// 滑动事件
		function touches(obj,direction,fun){
			//obj:ID对象
			//direction:swipeleft,swiperight,swipetop,swipedown,singleTap,touchstart,touchmove,touchend
			//          划左，    划右，     划上，   划下，    点击，    开始触摸， 触摸移动， 触摸结束
			//fun:回调函数
			var defaults = {x: 5,y: 5,ox:0,oy:0,nx:0,ny:0};
			direction=direction.toLowerCase();
			//配置：划的范围在5X5像素内当点击处理
			obj.addEventListener("touchstart",function() {
				defaults.ox = event.targetTouches[0].pageX;
				defaults.oy = event.targetTouches[0].pageY;
				defaults.nx = defaults.ox;
				defaults.ny = defaults.oy;
				if(direction.indexOf("touchstart")!=-1)fun();
			}, false);
			obj.addEventListener("touchmove",function() {
				event.preventDefault();
				defaults.nx = event.targetTouches[0].pageX;
				defaults.ny = event.targetTouches[0].pageY;
				if(direction.indexOf("touchmove")!=-1)fun();
			}, false);
			obj.addEventListener("touchend",function() {
				var changeY = defaults.oy - defaults.ny;
				var changeX = defaults.ox - defaults.nx;
				if(Math.abs(changeX)>Math.abs(changeY)&&Math.abs(changeY)>defaults.y){
					//左右事件
					if(changeX > 0) {
						if(direction.indexOf("swipeleft")!=-1)fun();
					}else{
						if(direction.indexOf("swiperight")!=-1)fun();
					}
				}else if(Math.abs(changeY)>Math.abs(changeX)&&Math.abs(changeX)>defaults.x){
					//上下事件
					if(changeY > 0) {
						if(direction.indexOf("swipetop")!=-1)fun();
					}else{
						if(direction.indexOf("swipedown")!=-1)fun();
					}
				}else{
					//点击事件
					if(direction.indexOf("singleTap")!=-1)fun();
				}
				if(direction.indexOf("touchend")!=-1)fun();
			}, false);
		};
		touches($("#top")[0],"swipeleft",aaa);
		touches($("#top")[0],"swiperight",bbb);
		touches($("#btm")[0],"swipeleft",aaa);
		touches($("#btm")[0],"swiperight",bbb);
		function aaa(){
			shake();
		}
		function bbb(){
			shake();
		}
	</script>
</body>
</html>